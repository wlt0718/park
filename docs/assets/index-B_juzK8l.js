import{u as j}from"./use-expose-CoHQvPjm.js";import{c as q,m as D,b as m,p as F,w as G}from"./with-install-DCDV9zmY.js";import{d as J,r as v,a as K,E as L,N as O,z as Q,c as S}from"./index-DB_EkmlV.js";const[U,z]=q("text-ellipsis"),X={rows:D(1),dots:m("..."),content:m(""),expandText:m(""),collapseText:m(""),position:m("end")};var Y=J({name:U,props:X,emits:["clickAction"],setup(t,{emit:I,slots:g}){const y=v(""),u=v(!1),T=v(!1),x=v();let h=!1;const w=K(()=>u.value?t.collapseText:t.expandText),E=n=>{if(!n)return 0;const e=n.match(/^\d*(\.\d*)?/);return e?Number(e[0]):0},V=()=>{if(!x.value||!x.value.isConnected)return;const n=window.getComputedStyle(x.value),e=document.createElement("div");return Array.prototype.slice.apply(n).forEach(f=>{e.style.setProperty(f,n.getPropertyValue(f))}),e.style.position="fixed",e.style.zIndex="-9999",e.style.top="-9999px",e.style.height="auto",e.style.minHeight="auto",e.style.maxHeight="auto",e.innerText=t.content,document.body.appendChild(e),e},N=()=>{const n=(l,k)=>{const{content:a,position:p,dots:r}=t,d=a.length,_=()=>{const o=(s,c)=>{if(c-s<=1)return p==="end"?a.slice(0,s)+r:r+a.slice(c,d);const i=Math.round((s+c)/2);return p==="end"?l.innerText=a.slice(0,i)+r+w.value:l.innerText=r+a.slice(i,d)+w.value,l.offsetHeight>k?p==="end"?o(s,i):o(i,c):p==="end"?o(i,c):o(s,i)};l.innerText=o(0,d)},C=(o,s)=>{if(o[1]-o[0]<=1&&s[1]-s[0]<=1)return a.slice(0,o[0])+r+a.slice(s[1],d);const c=Math.floor((o[0]+o[1])/2),i=Math.ceil((s[0]+s[1])/2);return l.innerText=t.content.slice(0,c)+t.dots+t.content.slice(i,d)+t.expandText,l.offsetHeight>=k?C([o[0],c],[i,s[1]]):C([c,o[1]],[s[0],i])},H=0+d>>1;return t.position==="middle"?l.innerText=C([0,H],[H,d]):_(),l.innerText},e=V();if(!e){h=!0;return}const{paddingBottom:M,paddingTop:f,lineHeight:W}=e.style,b=Math.ceil((Number(t.rows)+.5)*E(W)+E(f)+E(M));b<e.offsetHeight?(T.value=!0,y.value=n(e,b)):(T.value=!1,y.value=t.content),document.body.removeChild(e)},A=(n=!u.value)=>{u.value=n},B=n=>{A(),I("clickAction",n)},R=()=>{const n=g.action?g.action({expanded:u.value}):w.value;return S("span",{class:z("action"),onClick:B},[n])};return L(N),O(()=>{h&&(h=!1,N())}),Q([F,()=>[t.content,t.rows,t.position]],N),j({toggle:A}),()=>S("div",{ref:x,class:z()},[u.value?t.content:y.value,T.value?R():null])}});const ee=G(Y);export{ee as T};
